"use strict";const e=require("../../common/vendor.js"),t=require("../../api/index.js"),a={data:()=>({museum:{},showFeedback:!1,feedback:{rating:0,content:""}}),onLoad(e){e.id&&this.loadMuseumDetail(e.id)},methods:{async loadMuseumDetail(a){try{const e=await t.venueApi.getVenueDetail(a);this.museum=e}catch(o){console.error("加载展馆详情失败:",o),e.index.showToast({title:"加载展馆详情失败",icon:"none"})}},handleStartVR(){this.museum.url?e.index.navigateTo({url:`/pages/web-view/web-view?url=${encodeURIComponent(this.museum.url)}`}):e.index.showToast({title:"VR导览暂未开放",icon:"none"})},showFeedbackModal(){this.showFeedback=!0},closeFeedbackModal(){this.showFeedback=!1},setRating(e){this.feedback.rating=e},async submitFeedback(){if(0!==this.feedback.rating)try{await t.feedbackApi.submitFeedback({venueId:this.museum.id,userId:"wx_123456",content:this.feedback.content,rating:this.feedback.rating}),e.index.showToast({title:"反馈提交成功",icon:"success"}),this.closeFeedbackModal(),this.feedback={rating:0,content:""}}catch(a){console.error("提交反馈失败:",a),e.index.showToast({title:"提交反馈失败",icon:"none"})}else e.index.showToast({title:"请选择评分",icon:"none"})}}};const o=e._export_sfc(a,[["render",function(t,a,o,s,n,i){var c,d;return e.e({a:null==(d=null==(c=n.museum.images)?void 0:c[0])?void 0:d.url,b:e.t(n.museum.name),c:e.t(n.museum.openingHours),d:e.t(n.museum.address),e:e.t(n.museum.contact),f:e.t(n.museum.description),g:e.o(((...e)=>i.handleStartVR&&i.handleStartVR(...e))),h:e.o(((...e)=>i.showFeedbackModal&&i.showFeedbackModal(...e))),i:n.showFeedback},n.showFeedback?{j:e.o(((...e)=>i.closeFeedbackModal&&i.closeFeedbackModal(...e))),k:e.f(5,((t,a,o)=>({a:t,b:t<=n.feedback.rating?1:"",c:e.o((e=>i.setRating(t)),t)}))),l:n.feedback.content,m:e.o((e=>n.feedback.content=e.detail.value)),n:e.o(((...e)=>i.submitFeedback&&i.submitFeedback(...e))),o:e.o((()=>{})),p:e.o(((...e)=>i.closeFeedbackModal&&i.closeFeedbackModal(...e)))}:{})}]]);wx.createPage(o);
